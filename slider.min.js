class Slider{constructor(t,e={}){this.defaults={slidesToShow:1,slidesToScroll:1,infinite:!0,autoplay:!1,autoplaySpeed:3e3,speed:500,dots:!0,arrows:!0,fade:!1,responsive:[],breakpoints:{},debug:!1,lazyLoad:!1,lazyLoadAdjacent:1,swipeMomentum:!0,swipeVelocityThreshold:.5,adaptiveWidth:!1,onFirstSlide:null,onLastSlide:null,gap:0,captions:!1,progressBar:!1,thumbnails:!1,parallax:!1,direction:"horizontal",rtl:!1,respectReducedMotion:!0,slideClass:null},this.options={...this.defaults,...e},this.baseOptions={...this.options},this.currentBreakpoint=null,this.slider="string"==typeof t?document.querySelector(t):t,this.slider?("rtl"in e||(this.options.rtl=this.detectRTL(),this.baseOptions.rtl=this.options.rtl),this.prefersReducedMotion=this.detectReducedMotion(),this.currentSlide=0,this.isAnimating=!1,this.autoplayTimer=null,this.progressBarElement=null,this.thumbnailsContainer=null,this.isHandlingTouch=!1,this.eventHandlers={resize:null,touchstart:null,touchmove:null,touchend:null,mousedown:null,mousemove:null,mouseup:null,mouseleave:null,keydown:null,mouseenter:null,mouseleaveAutoplay:null,prevArrowClick:null,nextArrowClick:null},this.init()):console.error("SliderJS: Element not found")}detectRTL(){let t=this.slider;for(;t;){const e=window.getComputedStyle(t).direction||t.getAttribute("dir");if("rtl"===e)return!0;if("ltr"===e)return!1;t=t.parentElement}return!1}detectReducedMotion(){return!!window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches}getEffectiveSpeed(){return this.options.respectReducedMotion&&this.prefersReducedMotion?0:this.options.speed}createElementFromHTML(t){if("string"!=typeof t||!t.trim())return null;const e=(new DOMParser).parseFromString(t.trim(),"text/html"),i=e.querySelector("parsererror");if(i)return console.error("SliderJS: Failed to parse HTML string:",i.textContent),null;const s=e.body.firstElementChild;return s||(console.error("SliderJS: No valid element found in HTML string"),null)}sanitizeUrl(t){if("string"!=typeof t||!t)return"";const e=t.trim().toLowerCase(),i=["javascript:","data:text/html","vbscript:"];for(const s of i)if(e.startsWith(s))return console.warn("SliderJS: Blocked potentially dangerous URL scheme:",t),"";return t.trim()}debugLog(t,e,i={}){if(!this.options.debug)return;console.log(`%c[SliderJS ${t.toUpperCase()}]`,{state:"color: #4CAF50; font-weight: bold",event:"color: #2196F3; font-weight: bold",transition:"color: #FF9800; font-weight: bold"}[t]||"",e,i)}createDebugOverlay(){if(!this.options.debug)return;this.debugOverlay=document.createElement("div"),this.debugOverlay.classList.add("sliderjs-debug-overlay");const t=document.createElement("div");t.classList.add("sliderjs-debug-content");const e=document.createElement("strong");e.textContent="Debug Mode",t.appendChild(e);const i=document.createElement("div");i.classList.add("sliderjs-debug-info");const s=document.createElement("span");s.textContent="Current Slide: ";const o=document.createElement("span");o.classList.add("sliderjs-debug-slide"),o.textContent="0",s.appendChild(o),i.appendChild(s);const n=document.createElement("span");n.textContent="Total Slides: ";const r=document.createElement("span");r.classList.add("sliderjs-debug-total"),r.textContent=String(this.slideCount),n.appendChild(r),i.appendChild(n);const l=document.createElement("span");l.textContent="Animating: ";const d=document.createElement("span");d.classList.add("sliderjs-debug-animating"),d.textContent="false",l.appendChild(d),i.appendChild(l),t.appendChild(i),this.debugOverlay.appendChild(t),this.slider.appendChild(this.debugOverlay)}updateDebugOverlay(){if(!this.options.debug||!this.debugOverlay)return;const t=this.debugOverlay.querySelector(".sliderjs-debug-slide"),e=this.debugOverlay.querySelector(".sliderjs-debug-animating");t&&(t.textContent=this.currentSlide),e&&(e.textContent=this.isAnimating)}init(){this.debugLog("state","Initializing slider",{options:this.options}),this.options.fade&&this.options.slidesToShow>1&&(console.warn("SliderJS: Fade mode only works with slidesToShow: 1. Disabling fade mode."),this.options.fade=!1),this.options.adaptiveWidth&&this.options.slidesToShow>1&&(console.warn("SliderJS: Adaptive width mode only works with slidesToShow: 1. Disabling adaptive width."),this.options.adaptiveWidth=!1),this.options.adaptiveWidth&&this.options.fade&&(console.warn("SliderJS: Adaptive width mode does not work with fade mode. Disabling adaptive width."),this.options.adaptiveWidth=!1),this.options.adaptiveWidth&&"vertical"===this.options.direction&&(console.warn("SliderJS: Adaptive width mode does not work with vertical direction. Disabling adaptive width."),this.options.adaptiveWidth=!1),this.setupSlider(),this.setupControls(),this.bindEvents(),this.options.lazyLoad&&this.loadVisibleImages(),this.options.autoplay&&this.startAutoplay(),this.handleResize(),this.createDebugOverlay(),this.updateDebugOverlay(),this.updateAriaHidden(),this.updateArrowVisibility(),this.updateDotVisibility(),this.debugLog("state","Slider initialized",{slideCount:this.slideCount,currentSlide:this.currentSlide})}setupSlider(){this.slides=Array.from(this.slider.children),this.slideCount=this.slides.length,0!==this.slideCount?(this.slider.classList.add("sliderjs"),this.options.rtl&&this.slider.classList.add("sliderjs-rtl"),"vertical"===this.options.direction&&this.slider.classList.add("sliderjs-vertical"),this.slider.setAttribute("tabindex","0"),this.options.fade&&this.slider.classList.add("sliderjs-fade"),this.track=document.createElement("div"),this.track.classList.add("sliderjs-track"),this.options.gap>0&&(this.track.style.gap=`${this.options.gap}px`),this.slides.forEach((t,e)=>{if(t.classList.add("sliderjs-slide"),this.applyCustomClasses(t),this.options.adaptiveWidth)t.style.flex="0 0 auto",t.style.minWidth="auto";else{const e="vertical"===this.options.direction,i=e?"minHeight":"minWidth";if(this.options.gap>0){const s=`calc((100% - ${this.options.gap*(this.options.slidesToShow-1)}px) / ${this.options.slidesToShow})`;t.style.flex=`0 0 ${s}`,t.style[i]=s,e&&(t.style.width="100%")}else{const s=100/this.options.slidesToShow;t.style.flex=`0 0 ${s}%`,t.style[i]=`${s}%`,e&&(t.style.width="100%")}}this.options.fade&&(t.style.opacity=0===e?"1":"0",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.transition=`opacity ${this.getEffectiveSpeed()}ms cubic-bezier(0.4, 0, 0.2, 1)`),this.options.captions&&this.addCaptionToSlide(t),this.options.parallax&&this.setupParallaxForSlide(t),this.track.appendChild(t)}),this.slider.appendChild(this.track),this.options.infinite&&!this.options.fade&&this.cloneSlides(),this.goToSlide(0,!1)):console.warn("SliderJS: No slides found")}cloneSlides(){const t=this.slides.slice(-this.options.slidesToShow).map(t=>{const e=t.cloneNode(!0);return e.classList.add("sliderjs-clone"),e}),e=this.slides.slice(0,this.options.slidesToShow).map(t=>{const e=t.cloneNode(!0);return e.classList.add("sliderjs-clone"),e});t.forEach(t=>this.track.insertBefore(t,this.track.firstChild)),e.forEach(t=>this.track.appendChild(t)),this.currentSlide=this.options.slidesToShow}parseClassString(t){return t&&"string"==typeof t?t.split(/\s+/).filter(t=>t.length>0):[]}applyCustomClasses(t){const e=t.dataset.slideClass;if(e){this.parseClassString(e).forEach(e=>{e&&"string"==typeof e&&t.classList.add(e)})}if(this.options.slideClass)if(Array.isArray(this.options.slideClass))this.options.slideClass.forEach(e=>{e&&"string"==typeof e&&e.trim().length>0&&t.classList.add(e.trim())});else if("string"==typeof this.options.slideClass){this.parseClassString(this.options.slideClass).forEach(e=>{e&&"string"==typeof e&&t.classList.add(e)})}}addCaptionToSlide(t){const e=t.dataset.captionTitle,i=t.dataset.captionText;if(e||i){const s=document.createElement("div");if(s.classList.add("sliderjs-caption"),e){const t=document.createElement("h3");t.classList.add("sliderjs-caption-title"),t.textContent=e,s.appendChild(t)}if(i){const t=document.createElement("p");t.classList.add("sliderjs-caption-text"),t.textContent=i,s.appendChild(t)}t.appendChild(s),t.classList.add("sliderjs-has-caption")}}setupParallaxForSlide(t){const e=t.querySelectorAll("[data-parallax-speed]");if(0===e.length){Array.from(t.children).forEach((t,e)=>{if(!t.classList.contains("sliderjs-caption")){const i=0===e?.5:1.5;t.setAttribute("data-parallax-speed",i),t.classList.add("sliderjs-parallax-element")}})}else e.forEach(t=>{t.classList.add("sliderjs-parallax-element")})}applyParallaxEffect(t,e=0){if(!this.options.parallax)return;const i=t+(this.options.infinite?this.options.slidesToShow:0),s=Array.from(this.track.children);for(let t=-1;t<=1;t++){const o=i+t;if(o>=0&&o<s.length){s[o].querySelectorAll(".sliderjs-parallax-element").forEach(i=>{const s=parseFloat(i.getAttribute("data-parallax-speed")||1),o=100*(t-e)*(s-1);i.style.transform=`translateX(${o}px)`,i.style.transition=`transform ${this.getEffectiveSpeed()}ms cubic-bezier(0.4, 0, 0.2, 1)`})}}}resetParallaxEffect(){if(!this.options.parallax)return;Array.from(this.track.children).forEach(t=>{t.querySelectorAll(".sliderjs-parallax-element").forEach(t=>{t.style.transform="",t.style.transition=""})})}setupControls(){if(this.options.arrows){const t="vertical"===this.options.direction;this.prevArrow=document.createElement("button"),this.prevArrow.classList.add("sliderjs-arrow","sliderjs-prev"),this.prevArrow.textContent=t?"˄":"‹",this.prevArrow.setAttribute("aria-label","Previous slide"),this.nextArrow=document.createElement("button"),this.nextArrow.classList.add("sliderjs-arrow","sliderjs-next"),this.nextArrow.textContent=t?"˅":"›",this.nextArrow.setAttribute("aria-label","Next slide"),this.slider.appendChild(this.prevArrow),this.slider.appendChild(this.nextArrow)}if(this.options.dots){this.dotsContainer=document.createElement("div"),this.dotsContainer.classList.add("sliderjs-dots");const t=this.calculateDotCount();for(let e=0;e<t;e++){const i=document.createElement("button");i.classList.add("sliderjs-dot"),i.setAttribute("aria-label",`Go to slide ${e+1}`),0===e&&i.classList.add("active"),i.addEventListener("click",()=>{let i=e*this.options.slidesToScroll;if(!this.options.infinite){const s=this.slideCount-this.options.slidesToShow;i=Math.min(i,s),e===t-1&&i<s&&(i=s)}this.goToSlide(i)}),this.dotsContainer.appendChild(i)}this.slider.appendChild(this.dotsContainer)}if(this.options.progressBar&&this.options.autoplay){this.progressBarElement=document.createElement("div"),this.progressBarElement.classList.add("sliderjs-progress-bar"),this.progressBarElement.setAttribute("aria-hidden","true");const t=document.createElement("div");t.classList.add("sliderjs-progress-bar-fill"),this.progressBarElement.appendChild(t),this.slider.appendChild(this.progressBarElement)}this.options.thumbnails&&this.createThumbnails()}updateArrowVisibility(){if(!this.options.arrows||!this.prevArrow||!this.nextArrow)return;const t=this.options.infinite||this.slideCount>this.options.slidesToShow;if(t)if(this.options.infinite)this.prevArrow.classList.remove("sliderjs-arrow-hidden"),this.nextArrow.classList.remove("sliderjs-arrow-hidden"),this.prevArrow.setAttribute("aria-hidden","false"),this.nextArrow.setAttribute("aria-hidden","false");else{const t=this.slideCount-this.options.slidesToShow;this.currentSlide<=0?(this.prevArrow.classList.add("sliderjs-arrow-hidden"),this.prevArrow.setAttribute("aria-hidden","true")):(this.prevArrow.classList.remove("sliderjs-arrow-hidden"),this.prevArrow.setAttribute("aria-hidden","false")),this.currentSlide>=t?(this.nextArrow.classList.add("sliderjs-arrow-hidden"),this.nextArrow.setAttribute("aria-hidden","true")):(this.nextArrow.classList.remove("sliderjs-arrow-hidden"),this.nextArrow.setAttribute("aria-hidden","false"))}else this.prevArrow.classList.add("sliderjs-arrow-hidden"),this.nextArrow.classList.add("sliderjs-arrow-hidden"),this.prevArrow.setAttribute("aria-hidden","true"),this.nextArrow.setAttribute("aria-hidden","true");this.debugLog("state","Arrow visibility updated",{shouldShowArrows:t,currentSlide:this.currentSlide,slideCount:this.slideCount,slidesToShow:this.options.slidesToShow,infinite:this.options.infinite})}updateDotVisibility(){if(!this.options.dots||!this.dotsContainer)return;const t=this.calculateDotCount(),e=t>1;e?(this.dotsContainer.classList.remove("sliderjs-dots-hidden"),this.dotsContainer.setAttribute("aria-hidden","false")):(this.dotsContainer.classList.add("sliderjs-dots-hidden"),this.dotsContainer.setAttribute("aria-hidden","true")),this.debugLog("state","Dot visibility updated",{shouldShowDots:e,dotCount:t,slideCount:this.slideCount,slidesToShow:this.options.slidesToShow,infinite:this.options.infinite})}isNestedSlider(t){let e=t;for(;e&&e!==this.slider;){if(e.classList&&e.classList.contains("sliderjs"))return!0;e=e.parentElement}return!1}bindEvents(){this.options.arrows&&(this.eventHandlers.prevArrowClick=()=>this.prev(),this.eventHandlers.nextArrowClick=()=>this.next(),this.prevArrow.addEventListener("click",this.eventHandlers.prevArrowClick),this.nextArrow.addEventListener("click",this.eventHandlers.nextArrowClick));let t=0,e=0,i=0,s=0,o=0;this.eventHandlers.touchstart=e=>{this.isNestedSlider(e.target)?this.debugLog("event","Touch started on nested slider, ignoring"):(this.isHandlingTouch=!0,t=e.changedTouches[0].screenX,s=e.changedTouches[0].screenY,i=Date.now())},this.eventHandlers.touchmove=e=>{if(!this.isHandlingTouch)return;const i="vertical"===this.options.direction,o=e.changedTouches[0].screenX,n=e.changedTouches[0].screenY,r=Math.abs(o-t),l=Math.abs(n-s);i?l>r&&l>10&&(e.preventDefault(),e.stopPropagation()):r>l&&r>10&&(e.preventDefault(),e.stopPropagation())},this.eventHandlers.touchend=n=>{if(!this.isHandlingTouch)return;const r="vertical"===this.options.direction;e=n.changedTouches[0].screenX,o=n.changedTouches[0].screenY;const l=Date.now();r?this.handleSwipe(s,o,i,l):this.handleSwipe(t,e,i,l),n.stopPropagation(),this.isHandlingTouch=!1},this.slider.addEventListener("touchstart",this.eventHandlers.touchstart),this.slider.addEventListener("touchmove",this.eventHandlers.touchmove,{passive:!1}),this.slider.addEventListener("touchend",this.eventHandlers.touchend);let n=!1,r=0,l=0,d=0,a=0,h=0;const c=t=>{if(!n)return;n=!1;const e="vertical"===this.options.direction;l=t.clientX,a=t.clientY;const i=Date.now();this.slider.classList.remove("sliderjs-dragging"),e?this.handleSwipe(d,a,h,i):this.handleSwipe(r,l,h,i),t&&t.stopPropagation()};this.eventHandlers.mousedown=t=>{0===t.button&&(t.target.closest(".sliderjs-arrow")||t.target.closest(".sliderjs-dot")||(this.isNestedSlider(t.target)?this.debugLog("event","Mouse down on nested slider, ignoring"):(n=!0,r=t.clientX,d=t.clientY,h=Date.now(),this.slider.classList.add("sliderjs-dragging"),t.preventDefault(),t.stopPropagation())))},this.eventHandlers.mousemove=t=>{n&&(t.preventDefault(),t.stopPropagation(),l=t.clientX,a=t.clientY)},this.eventHandlers.mouseup=c,this.eventHandlers.mouseleave=c,this.slider.addEventListener("mousedown",this.eventHandlers.mousedown),this.slider.addEventListener("mousemove",this.eventHandlers.mousemove),this.slider.addEventListener("mouseup",this.eventHandlers.mouseup),this.slider.addEventListener("mouseleave",this.eventHandlers.mouseleave),this.eventHandlers.resize=()=>this.handleResize(),window.addEventListener("resize",this.eventHandlers.resize),this.options.autoplay&&(this.eventHandlers.mouseenter=()=>this.pauseAutoplay(),this.eventHandlers.mouseleaveAutoplay=()=>this.startAutoplay(),this.slider.addEventListener("mouseenter",this.eventHandlers.mouseenter),this.slider.addEventListener("mouseleave",this.eventHandlers.mouseleaveAutoplay)),this.eventHandlers.keydown=t=>{if(this.isNestedSlider(t.target))return void this.debugLog("event","Keyboard event on nested slider, ignoring");"vertical"===this.options.direction?"ArrowUp"===t.key?(t.preventDefault(),t.stopPropagation(),this.debugLog("event","ArrowUp key pressed"),this.prev()):"ArrowDown"===t.key&&(t.preventDefault(),t.stopPropagation(),this.debugLog("event","ArrowDown key pressed"),this.next()):"ArrowLeft"===t.key?(t.preventDefault(),t.stopPropagation(),this.debugLog("event","ArrowLeft key pressed"),this.options.rtl?this.next():this.prev()):"ArrowRight"===t.key&&(t.preventDefault(),t.stopPropagation(),this.debugLog("event","ArrowRight key pressed"),this.options.rtl?this.prev():this.next())},this.slider.addEventListener("keydown",this.eventHandlers.keydown)}handleSwipe(t,e,i,s){let o=t-e;this.options.rtl&&"horizontal"===this.options.direction&&(o=-o);const n=Math.max(1,s-i),r=Math.abs(o)/n,l=this.options.swipeVelocityThreshold;if(this.debugLog("event","Swipe detected",{distance:o,duration:n,velocity:r.toFixed(3),velocityThreshold:l}),this.options.swipeMomentum){if(r>=l)return void(o>0?(this.debugLog("event","Fast swipe left (momentum)",{velocity:r.toFixed(3)}),this.next()):o<0&&(this.debugLog("event","Fast swipe right (momentum)",{velocity:r.toFixed(3)}),this.prev()));if(Math.abs(o)>50)if(this.options.adaptiveWidth)o>0?this.next():this.prev();else{const t=this.slides[0]?this.slides[0].offsetWidth:0;if(t>0){const e=Math.min(3,Math.max(1,Math.round(Math.abs(o)/t)));this.debugLog("event","Slow swipe with proportional movement",{distance:o,slideWidth:t,slidesToMove:e});const i=o>0?1:-1;let s=this.currentSlide+e*this.options.slidesToScroll*i;if(!this.options.infinite){const t=this.slideCount-this.options.slidesToShow;s=Math.max(0,Math.min(s,t))}this.goToSlide(s)}else o>0?this.next():this.prev()}}else Math.abs(o)>50&&(o>0?(this.debugLog("event","Swipe left detected",{distance:o}),this.next()):(this.debugLog("event","Swipe right detected",{distance:o}),this.prev()))}goToSlide(t,e=!0,i=!1){if(!this.isAnimating&&this.slides&&0!==this.slides.length){if(this.debugLog("transition","Going to slide",{from:this.currentSlide,to:t,animate:e}),this.options.fade){e&&(this.isAnimating=!0),this.slides.forEach((t,e)=>{e===this.currentSlide&&(t.style.opacity="0",t.style.zIndex="1")});let s=t;this.options.infinite?t>=this.slideCount?s=0:t<0&&(s=this.slideCount-1):s=Math.max(0,Math.min(t,this.slideCount-1)),this.slides[s].style.opacity="1",this.slides[s].style.zIndex="2",this.currentSlide=s,e?setTimeout(()=>{this.isAnimating=!1,i||this.checkSlideCallbacks()},this.getEffectiveSpeed()):i||this.checkSlideCallbacks()}else{const s=t+(this.options.infinite?this.options.slidesToShow:0);e?(this.isAnimating=!0,this.track.style.transition=`transform ${this.getEffectiveSpeed()}ms cubic-bezier(0.4, 0, 0.2, 1)`):this.track.style.transition="none";const o="vertical"===this.options.direction;let n=0;if(this.options.adaptiveWidth&&!o){const t=Array.from(this.track.children);for(let e=0;e<s&&e<t.length;e++)n-=t[e].offsetWidth;this.options.gap>0&&s>0&&(n-=s*this.options.gap)}else{const t=this.slides[0];if(t){const e=o?t.offsetHeight:t.offsetWidth;if(e>0){n=-s*e-(this.options.gap>0?s*this.options.gap:0)}}}this.options.rtl&&!o&&(n=-n),this.track.style.transform=o?`translateY(${n}px)`:`translateX(${n}px)`,this.currentSlide=t,this.options.parallax&&e&&this.applyParallaxEffect(t,0),e?setTimeout(()=>{this.isAnimating=!1,this.handleInfiniteLoop(),this.updateDebugOverlay(),this.options.parallax&&this.resetParallaxEffect(),i||this.checkSlideCallbacks()},this.getEffectiveSpeed()):(this.options.parallax&&this.resetParallaxEffect(),i||this.checkSlideCallbacks())}this.updateDots(),this.updateThumbnails(),this.updateAriaHidden(),this.updateDebugOverlay(),this.updateArrowVisibility(),this.options.progressBar&&this.options.autoplay&&this.autoplayTimer&&this.startProgressBar(),this.options.lazyLoad&&(e?setTimeout(()=>{this.loadVisibleImages()},this.getEffectiveSpeed()):this.loadVisibleImages()),this.debugLog("state","Slide changed",{currentSlide:this.currentSlide,isAnimating:this.isAnimating})}}handleInfiniteLoop(){this.options.infinite&&(this.currentSlide>=this.slideCount?(this.currentSlide=0,this.goToSlide(0,!1,!0)):this.currentSlide<0&&(this.currentSlide=this.slideCount-1,this.goToSlide(this.slideCount-1,!1,!0)))}updateAriaHidden(){if(!this.slides||0===this.slides.length)return;const t=new Set;let e=this.currentSlide;e=this.options.infinite?(this.currentSlide%this.slideCount+this.slideCount)%this.slideCount:Math.max(0,Math.min(this.currentSlide,this.slideCount-1));for(let i=0;i<this.options.slidesToShow;i++){const s=(e+i)%this.slideCount;t.add(s)}const i='a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])';(this.track?this.track.querySelectorAll(".sliderjs-slide"):this.slides).forEach((e,s)=>{let o=s;if(this.options.infinite&&this.track){const t=this.options.slidesToShow;o=s<t?this.slideCount+s-t:s>=t+this.slideCount?s-t-this.slideCount:s-t}if(t.has(o)){e.setAttribute("aria-hidden","false");e.querySelectorAll(i).forEach(t=>{if(t.hasAttribute("data-original-tabindex")){const e=t.getAttribute("data-original-tabindex");t.setAttribute("tabindex",e),t.removeAttribute("data-original-tabindex")}else t.hasAttribute("data-had-no-tabindex")&&(t.removeAttribute("tabindex"),t.removeAttribute("data-had-no-tabindex"))})}else{e.setAttribute("aria-hidden","true");e.querySelectorAll(i).forEach(t=>{t.hasAttribute("data-original-tabindex")||t.hasAttribute("data-had-no-tabindex")||(t.hasAttribute("tabindex")?t.setAttribute("data-original-tabindex",t.getAttribute("tabindex")):t.setAttribute("data-had-no-tabindex","true")),t.setAttribute("tabindex","-1")})}}),this.debugLog("state","Updated aria-hidden attributes",{currentSlide:this.currentSlide,normalizedSlide:e,visibleSlides:Array.from(t)})}updateDots(){if(!this.options.dots||!this.dotsContainer)return;const t=this.dotsContainer.querySelectorAll(".sliderjs-dot");let e=Math.floor(this.currentSlide/this.options.slidesToScroll);if(!this.options.infinite){const i=this.slideCount-this.options.slidesToShow;this.currentSlide>=i-(this.options.slidesToScroll-1)&&(e=t.length-1)}e=Math.max(0,Math.min(e,t.length-1)),t.forEach((t,i)=>{t.classList.remove("active"),i===e&&t.classList.add("active")})}createThumbnails(){this.thumbnailsContainer=document.createElement("div"),this.thumbnailsContainer.classList.add("sliderjs-thumbnails"),this.slides.forEach((t,e)=>{const i=document.createElement("button");i.classList.add("sliderjs-thumbnail"),i.setAttribute("aria-label",`Go to slide ${e+1}`);const s=t.getAttribute("data-thumbnail"),o=t.querySelector("img");if(s){const t=document.createElement("img");t.src=this.sanitizeUrl(s),t.alt=`Thumbnail ${e+1}`,i.appendChild(t)}else if(o){const t=document.createElement("img"),s=o.getAttribute("src")||o.getAttribute("data-src")||"";t.src=this.sanitizeUrl(s),t.alt=`Thumbnail ${e+1}`,i.appendChild(t)}else{const t=document.createElement("span");t.textContent=e+1,i.appendChild(t)}0===e&&i.classList.add("active"),i.addEventListener("click",()=>{this.goToSlide(e)}),this.thumbnailsContainer.appendChild(i)}),this.slider.appendChild(this.thumbnailsContainer)}updateThumbnails(){if(!this.options.thumbnails||!this.thumbnailsContainer)return;const t=this.thumbnailsContainer.querySelectorAll(".sliderjs-thumbnail");let e=this.currentSlide;this.options.infinite&&(e=this.normalizeIndex(this.currentSlide)),e=Math.max(0,Math.min(e,this.slideCount-1)),t.forEach((t,i)=>{t.classList.remove("active"),i===e&&t.classList.add("active")})}next(){this.debugLog("event","Next button clicked",{currentSlide:this.currentSlide});let t=this.currentSlide+this.options.slidesToScroll;const e=this.slideCount-this.options.slidesToShow;if(!this.options.infinite&&t>e){if(!(this.currentSlide<e))return void this.debugLog("event","Cannot go next (already at end)",{currentSlide:this.currentSlide,maxSlide:e});t=e}this.goToSlide(t)}prev(){this.debugLog("event","Previous button clicked",{currentSlide:this.currentSlide});const t=this.currentSlide-this.options.slidesToScroll;!this.options.infinite&&t<0?this.debugLog("event","Cannot go prev (reached start)",{currentSlide:this.currentSlide}):this.goToSlide(t)}goTo(t,e=!0){if("number"!=typeof t||t<0)console.warn("SliderJS: goTo() requires a valid slide index (>= 0)");else{if(!this.options.infinite){const e=this.slideCount-this.options.slidesToShow;t=Math.max(0,Math.min(t,e))}this.goToSlide(t,e)}}play(){this.options.autoplay||(this.options.autoplay=!0),this.startAutoplay()}pause(){this.pauseAutoplay()}startAutoplay(){this.options.autoplay&&(this.debugLog("event","Autoplay started",{speed:this.options.autoplaySpeed}),this.pauseAutoplay(),this.autoplayTimer=setInterval(()=>{this.next()},this.options.autoplaySpeed),this.startProgressBar())}pauseAutoplay(){this.autoplayTimer&&(this.debugLog("event","Autoplay paused"),clearInterval(this.autoplayTimer),this.autoplayTimer=null),this.pauseProgressBar()}startProgressBar(){if(!this.options.progressBar||!this.progressBarElement)return;const t=this.progressBarElement.querySelector(".sliderjs-progress-bar-fill");t&&(t.style.transition="none",t.style.width="0%",t.offsetWidth,requestAnimationFrame(()=>{t.style.transition=`width ${this.options.autoplaySpeed}ms linear`,t.style.width="100%"}))}pauseProgressBar(){if(!this.options.progressBar||!this.progressBarElement)return;const t=this.progressBarElement.querySelector(".sliderjs-progress-bar-fill");if(!t)return;const e=window.getComputedStyle(t).width;t.style.transition="none",t.style.width=e}handleResize(){const t=window.innerWidth;let e=null,i=null;if(this.baseOptions.breakpoints&&Object.keys(this.baseOptions.breakpoints).length>0){const s=Object.keys(this.baseOptions.breakpoints).map(t=>parseInt(t)).sort((t,e)=>e-t);for(const o of s)t<=o&&(e=o,i=this.baseOptions.breakpoints[o]);if(this.debugLog("state","Breakpoint check",{windowWidth:t,newBreakpoint:e,currentBreakpoint:this.currentBreakpoint}),e!==this.currentBreakpoint){this.currentBreakpoint=e;const t={...this.baseOptions};if(i){const e={...i};void 0!==e.itemsPerSlide&&(e.slidesToShow=e.itemsPerSlide),Object.assign(t,e)}this.debugLog("state","Applying breakpoint settings",{breakpoint:e,settings:i}),this.applyBreakpointSettings(t)}}else if(this.baseOptions.responsive&&this.baseOptions.responsive.length>0){let i={};for(const s of this.baseOptions.responsive)if(t<=s.breakpoint){i=s.settings,e=s.breakpoint;break}if(e!==this.currentBreakpoint){this.currentBreakpoint=e;const t={...this.baseOptions};Object.assign(t,i),this.applyBreakpointSettings(t)}}this.options.adaptiveWidth&&!this.options.fade&&this.goToSlide(this.currentSlide,!1),this.options.gap>0&&!this.options.fade&&!this.options.adaptiveWidth&&this.updateSlideWidths()}updateSlideWidths(){if(!this.slides||0===this.slides.length)return;const t=`calc((100% - ${this.options.gap*(this.options.slidesToShow-1)}px) / ${this.options.slidesToShow})`;Array.from(this.track.children).forEach(e=>{e.style.flex=`0 0 ${t}`,e.style.minWidth=t}),this.goToSlide(this.currentSlide,!1)}applyBreakpointSettings(t){const e=this.options.slidesToShow!==t.slidesToShow||this.options.fade!==t.fade||this.options.infinite!==t.infinite||this.options.dots!==t.dots||this.options.arrows!==t.arrows||this.options.adaptiveWidth!==t.adaptiveWidth||this.options.gap!==t.gap||this.options.captions!==t.captions;if(this.debugLog("state","Checking if rebuild needed",{needsRebuild:e,oldSlidesToShow:this.options.slidesToShow,newSlidesToShow:t.slidesToShow}),e){const e=null!==this.autoplayTimer,i=this.getCurrentSlide();this.pauseAutoplay(),this.options=t,this.rebuildSlider(),this.goToSlide(i,!1),e&&this.options.autoplay&&this.startAutoplay()}else this.options=t,this.autoplayTimer&&this.options.autoplay&&this.startAutoplay()}rebuildSlider(){this.debugLog("state","Rebuilding slider structure"),this.cleanupSlider(),this.setupSlider(),this.setupControls(),this.options.arrows&&(this.prevArrow.addEventListener("click",()=>this.prev()),this.nextArrow.addEventListener("click",()=>this.next())),this.options.debug&&(this.debugOverlay&&this.debugOverlay.remove(),this.createDebugOverlay(),this.updateDebugOverlay()),this.options.lazyLoad&&this.loadVisibleImages(),this.updateArrowVisibility(),this.updateDotVisibility()}cleanupSlider(){this.prevArrow&&(this.prevArrow.remove(),this.prevArrow=null),this.nextArrow&&(this.nextArrow.remove(),this.nextArrow=null),this.dotsContainer&&(this.dotsContainer.remove(),this.dotsContainer=null),this.debugOverlay&&(this.debugOverlay.remove(),this.debugOverlay=null);Array.from(this.track.children).forEach(t=>{t.classList.contains("sliderjs-clone")?t.remove():(t.style.flex="",t.style.minWidth="",t.style.opacity="",t.style.position="",t.style.top="",t.style.left="",t.style.width="",t.style.transition="",t.style.zIndex="",this.slider.appendChild(t))}),this.track&&(this.track.remove(),this.track=null),this.slider.classList.remove("sliderjs-fade"),this.slider.classList.remove("sliderjs-rtl")}normalizeIndex(t){return this.options.infinite?(t%this.slideCount+this.slideCount)%this.slideCount:t}checkSlideCallbacks(){const t=this.options.infinite?this.normalizeIndex(this.currentSlide):this.currentSlide;0===t&&"function"==typeof this.options.onFirstSlide&&(this.debugLog("event","First slide reached, triggering callback"),this.options.onFirstSlide(t)),t===this.slideCount-1&&"function"==typeof this.options.onLastSlide&&(this.debugLog("event","Last slide reached, triggering callback"),this.options.onLastSlide(t))}getSlidesToLoad(){const t=new Set,e=this.options.lazyLoadAdjacent||1;for(let e=0;e<this.options.slidesToShow;e++)t.add(this.currentSlide+e);for(let i=1;i<=e;i++)t.add(this.currentSlide-i),t.add(this.currentSlide+this.options.slidesToShow-1+i);const i=Array.from(t).filter(t=>!!this.options.infinite||t>=0&&t<this.slideCount).map(t=>this.normalizeIndex(t));return this.debugLog("state","Slides to load",{indices:i,currentSlide:this.currentSlide}),i}loadVisibleImages(){if(!this.options.lazyLoad)return;this.getSlidesToLoad().forEach(t=>{this.loadSlideImage(t)})}loadSlideImage(t){if((t=this.normalizeIndex(t))<0||t>=this.slideCount)return;const e=this.slides[t];if(!e)return;e.querySelectorAll("img[data-src]").forEach(e=>{if(e.classList.contains("sliderjs-loaded"))return;const i=e.getAttribute("data-src");if(!i)return;const s=this.sanitizeUrl(i);if(!s)return void console.warn("SliderJS: Skipped loading image with invalid URL:",i);this.debugLog("event","Loading image",{index:t,src:s}),e.classList.add("sliderjs-loading");const o=new Image;o.onload=()=>{e.src=s,e.removeAttribute("data-src"),e.classList.remove("sliderjs-loading"),e.classList.add("sliderjs-loaded"),this.debugLog("event","Image loaded",{index:t,src:s})},o.onerror=()=>{e.classList.remove("sliderjs-loading"),e.classList.add("sliderjs-error"),console.error("SliderJS: Failed to load image",s)},o.src=s})}getCurrentSlide(){return this.options.infinite?this.normalizeIndex(this.currentSlide):this.currentSlide}getSlideCount(){return this.slideCount}getValidInsertIndex(t){return null!==t&&t>=0&&t<=this.slideCount?t:this.slideCount}calculateDotCount(){if(this.options.infinite){const t=this.options.slidesToShow,e=this.options.slidesToScroll,i=Math.ceil((this.slideCount-t+e)/e);return Math.max(1,i)}{const t=this.slideCount-this.options.slidesToShow,e=this.options.slidesToScroll;let i=Math.floor(t/e)+1;return t%e!==0&&i++,Math.max(1,i)}}addSlide(t,e=null){let i;if(this.debugLog("event","Adding slide",{index:e,content:t}),"string"==typeof t){if(i=this.createElementFromHTML(t),!i)return void console.error("SliderJS: addSlide() could not create slide from provided HTML string")}else{if(!(t instanceof HTMLElement))return void console.error("SliderJS: addSlide() requires a valid HTML string or HTMLElement");i=t}const s=this.getValidInsertIndex(e);if(i.classList.add("sliderjs-slide"),this.applyCustomClasses(i),this.options.adaptiveWidth)i.style.flex="0 0 auto",i.style.minWidth="auto";else{const t="vertical"===this.options.direction,e=t?"minHeight":"minWidth";if(this.options.gap>0){const s=`calc((100% - ${this.options.gap*(this.options.slidesToShow-1)}px) / ${this.options.slidesToShow})`;i.style.flex=`0 0 ${s}`,i.style[e]=s,t&&(i.style.width="100%")}else{const s=100/this.options.slidesToShow;i.style.flex=`0 0 ${s}%`,i.style[e]=`${s}%`,t&&(i.style.width="100%")}}this.options.fade&&(i.style.opacity="0",i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.transition=`opacity ${this.getEffectiveSpeed()}ms cubic-bezier(0.4, 0, 0.2, 1)`),this.options.captions&&this.addCaptionToSlide(i),this.options.parallax&&this.setupParallaxForSlide(i),this.slides.splice(s,0,i),this.slideCount=this.slides.length,this.updateTrackAfterChange(s,"add"),this.rebuildControls(),s<=this.currentSlide&&this.currentSlide++,this.goToSlide(this.currentSlide,!1),this.updateAriaHidden(),this.updateArrowVisibility(),this.updateDotVisibility(),this.debugLog("state","Slide added",{slideCount:this.slideCount,currentSlide:this.currentSlide})}removeSlide(t){if(this.debugLog("event","Removing slide",{index:t}),"number"!=typeof t||t<0||t>=this.slideCount)return void console.error("SliderJS: removeSlide() requires a valid slide index (0 to "+(this.slideCount-1)+")");if(this.slideCount<=1)return void console.warn("SliderJS: Cannot remove the last slide");const e=this.slides[t];this.slides.splice(t,1),this.slideCount=this.slides.length,this.updateTrackAfterChange(t,"remove",e),this.rebuildControls(),t<this.currentSlide?this.currentSlide--:t===this.currentSlide&&this.currentSlide>=this.slideCount&&(this.currentSlide=this.slideCount-1),this.currentSlide=Math.max(0,Math.min(this.currentSlide,this.slideCount-1)),this.goToSlide(this.currentSlide,!1),this.updateAriaHidden(),this.updateArrowVisibility(),this.updateDotVisibility(),this.debugLog("state","Slide removed",{slideCount:this.slideCount,currentSlide:this.currentSlide})}updateTrackAfterChange(t,e,i=null){if(this.options.infinite&&!this.options.fade){this.track.querySelectorAll(".sliderjs-clone").forEach(t=>t.remove()),"function"==typeof this.track.replaceChildren?this.track.replaceChildren(...this.slides):(this.track.innerHTML="",this.slides.forEach(t=>{this.track.appendChild(t)})),this.cloneSlides()}else"function"==typeof this.track.replaceChildren?this.track.replaceChildren(...this.slides):(this.track.innerHTML="",this.slides.forEach(t=>{this.track.appendChild(t)}))}rebuildControls(){if(this.options.dots&&this.dotsContainer){this.dotsContainer.innerHTML="";const t=this.calculateDotCount();for(let e=0;e<t;e++){const i=document.createElement("button");i.classList.add("sliderjs-dot"),i.setAttribute("aria-label",`Go to slide ${e+1}`),i.addEventListener("click",()=>{let i=e*this.options.slidesToScroll;if(!this.options.infinite){const s=this.slideCount-this.options.slidesToShow;i=Math.min(i,s),e===t-1&&i<s&&(i=s)}this.goToSlide(i)}),this.dotsContainer.appendChild(i)}this.updateDots()}this.options.thumbnails&&this.thumbnailsContainer&&(this.thumbnailsContainer.innerHTML="",this.slides.forEach((t,e)=>{const i=document.createElement("button");i.classList.add("sliderjs-thumbnail"),i.setAttribute("aria-label",`Go to slide ${e+1}`);const s=t.getAttribute("data-thumbnail"),o=t.querySelector("img");if(s){const t=document.createElement("img");t.src=this.sanitizeUrl(s),t.alt=`Thumbnail ${e+1}`,i.appendChild(t)}else if(o){const t=document.createElement("img"),s=o.getAttribute("src")||o.getAttribute("data-src")||"";t.src=this.sanitizeUrl(s),t.alt=`Thumbnail ${e+1}`,i.appendChild(t)}else{const t=document.createElement("span");t.textContent=e+1,i.appendChild(t)}i.addEventListener("click",()=>{this.goToSlide(e)}),this.thumbnailsContainer.appendChild(i)}),this.updateThumbnails()),this.updateDebugOverlay()}destroy(){this.debugLog("event","Destroying slider"),this.pauseAutoplay(),this.eventHandlers.resize&&window.removeEventListener("resize",this.eventHandlers.resize),this.eventHandlers.touchstart&&this.slider.removeEventListener("touchstart",this.eventHandlers.touchstart),this.eventHandlers.touchmove&&this.slider.removeEventListener("touchmove",this.eventHandlers.touchmove),this.eventHandlers.touchend&&this.slider.removeEventListener("touchend",this.eventHandlers.touchend),this.eventHandlers.mousedown&&this.slider.removeEventListener("mousedown",this.eventHandlers.mousedown),this.eventHandlers.mousemove&&this.slider.removeEventListener("mousemove",this.eventHandlers.mousemove),this.eventHandlers.mouseup&&this.slider.removeEventListener("mouseup",this.eventHandlers.mouseup),this.eventHandlers.mouseleave&&this.slider.removeEventListener("mouseleave",this.eventHandlers.mouseleave),this.eventHandlers.keydown&&this.slider.removeEventListener("keydown",this.eventHandlers.keydown),this.eventHandlers.mouseenter&&this.slider.removeEventListener("mouseenter",this.eventHandlers.mouseenter),this.eventHandlers.mouseleaveAutoplay&&this.slider.removeEventListener("mouseleave",this.eventHandlers.mouseleaveAutoplay),this.options.arrows&&this.prevArrow&&this.nextArrow&&(this.eventHandlers.prevArrowClick&&this.prevArrow.removeEventListener("click",this.eventHandlers.prevArrowClick),this.eventHandlers.nextArrowClick&&this.nextArrow.removeEventListener("click",this.eventHandlers.nextArrowClick),this.prevArrow.remove(),this.nextArrow.remove()),this.options.dots&&this.dotsContainer&&this.dotsContainer.remove(),this.progressBarElement&&this.progressBarElement.remove(),this.thumbnailsContainer&&this.thumbnailsContainer.remove(),this.debugOverlay&&this.debugOverlay.remove(),this.slider.classList.remove("sliderjs","sliderjs-rtl","sliderjs-vertical","sliderjs-fade","sliderjs-dragging"),this.slider.removeAttribute("tabindex"),this.slides.forEach(t=>{t.classList.remove("sliderjs-slide"),t.style.flex="",t.style.minWidth="",t.style.minHeight="",t.style.width="",t.style.height="",t.style.opacity="",t.style.position="",t.style.top="",t.style.left="",t.style.transition="",t.style.transform="";const e=t.querySelector(".sliderjs-caption");e&&e.remove();t.querySelectorAll("[data-parallax-speed]").forEach(t=>{t.style.transform="",t.style.transition=""}),this.slider.appendChild(t)}),this.track&&this.track.remove(),this.slides=null,this.track=null,this.prevArrow=null,this.nextArrow=null,this.dotsContainer=null,this.progressBarElement=null,this.thumbnailsContainer=null,this.debugOverlay=null,this.autoplayTimer=null,this.eventHandlers=null,this.currentSlide=0,this.isAnimating=!1,this.isHandlingTouch=!1,this.debugLog("event","Slider destroyed successfully")}}"undefined"!=typeof module&&module.exports?module.exports=Slider:window.Slider=Slider;